name: nvidia-cleanup
type: shell
commands:
  - apt remove -y zutty gnome-shell-extension-prefs
  - rm /etc/apt/sources.list.d/nvidia-drivers.list 

modules:
- name: vanilla-tools
  type: shell
  sources:
    - type: tar
      url: https://github.com/Vanilla-OS/vanilla-tools/releases/download/v1.0.0/vanilla-tools.tar.gz
      checksum: 0e1d92d9c9154f9a115e97b40ff692afa52ddd0d9f770a8ec67440bf1a48aa72
  commands:
    - mkdir -p /usr/bin
    - cp /sources/vanilla-tools/vanilla-tools/vanilla-tools/nrun /usr/bin/nrun
    - cp /sources/vanilla-tools/vanilla-tools/vanilla-tools/prime-switch /usr/bin/prime-switch
    - chmod +x /usr/bin/nrun
    - chmod +x /usr/bin/prime-switch

- name: nvidia-gfx-fw
  type: apt
  sources:
    - packages:
      - firmware-nvidia-graphics

- name: enable-wayland
  type: shell
  commands:
    - mkdir -p /etc/udev/rules.d
    - ln -s /dev/null /etc/udev/rules.d/61-gdm.rules